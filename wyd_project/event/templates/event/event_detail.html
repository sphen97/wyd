{% extends "event/base.html" %}
{% block content %}
  <article class="content-section container">

        <!-- Event Data -->
        <div class="event-details row">
          <div class="media">
            <div class="event-metadata col-md-4.5">
              <img class="rounded event-img" src="../../media/group_sample.jpg"> <!-- need to makeinto template that pulls from RSO media -->
              <p>
                  <br>
                  <a class="mr-2" href="{% url 'user-events' event.host.username %}">Created by: {{ object.host }}</a>
                  <br>
                  <small class="text-muted">on {{ object.date_posted|date:"F d, Y" }}</small>
              </p>
            </div>

            <!-- Description -->
            <div class="event-body col-md-7.5">
              <p>
                <h2 class="event-title" align="center" style="color: white; letter-spacing: 3px;">{{ object.title }}</h2>
              </p>
              <p class="event-content">{{ object.description }}</p>
            </div>
          </div>  
        </div>

        <div class="event-details-bottom row">
          <ul class="nav nav-tabs">
            <li class="nav-item">
              <a class="nav-link active" data-toggle="pill" href="#eventInfo"> Event Information </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="pill" href="#eventComments"> Comments </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="pill" href="#mapLocation"> Location </a>
            </li>
          </ul>

          <div class="tab-content">

            <div class="tab-pane container active" id="eventInfo">
                <!-- Event contact information -->
                <div class="event-contact" id="eventInfo">
                  <div class="event-information">
                    <div class="card" width="300px">
                      <div class="card-body" align="center">
                        <table class="table table-md table-custom">
                          <tr>
                            <td>Event date: <i>{{ event.date }}</i></td>
                            <td>Hosted by: <i><a href="{% url 'rso-events' event.rso.id %}">{{ event.rso }}</a></i></td>
                          </tr>
                          <tr>
                            <td>Event time: <i>{{ event.time }}</i></td>
                            <td>University: <i><a href="{% url 'university-events' event.university.id %}">{{ event.university }}</a></i></td>
                          </tr>              
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
            </div>
            <!-- Event comment section with overflow scroll -->
            <div class="tab-pane container fade event-comment" id="eventComments">
                <a class="btn btn-default" href="{% url 'add_comment_to_post' pk=event.pk %}">Add comment</a>
                {% for comment in object.comments.all %}
                  <div class="comment-display">
                     <div class="card comment-content">
                         <p> {{comment.author}}</p>
                         <p> {{comment.text}}</p>
                         <p> {{comment.rating}}</p>
                         <p> {{comment.date_posted}}</p>
                     </div>
                  </div>
                {% endfor %}
            </div>

            <div class="tab-pane container fade event-location" id="mapLocation">
              <div class="card map-display"> 
                <a class="btn btn-default" href="{% url 'map-view' pk=event.pk %}"> Location Set </a>
              </div>
            </div>

          </div>

        </div>

        <!-- Only populate and allow admin to Update or Delete -->
        {% if object.host == user %}
          <div>
            <a class="btn btn-primary btn-sm mt-1 mb-1" data-toggle="modal" data-target="#updateModal" href="">Update</a>
            <a class="btn btn-danger btn-sm mt-1 mb-1" href="{% url 'event-delete' pk=event.pk%}">Delete</a>
            <!-- <a class="btn btn-danger btn-sm mt-1 mb-1" data-toggle="modal" data-target="#deleteModal" href="">Delete</a> -->
          </div>

          <!-- Update modal -->
          <div class="modal fade" id="updateModal">
            <div class="modal-dialog modal-xl">
              <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                  <p class="modal-title text-center" style="font-size: 30px">{{ object.title }}</p>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
<!--                   <div class="modal-body row-md">
                    <div class="col-md-12">
                      <p class="event-content"></p>
                    </div>
                  </div> -->

                  <!-- Modal footer -->
                  <div class="modal-footer">
                    <button class="btn btn-success" type="submit">Update</button>
                    <button class="btn btn-danger" data-dismiss="modal">Cancel</button>
                  </div>
                </form>

              </div>
            </div>
          </div>

          <!-- Delete modal -->
          <div class="modal fade" id="deleteModal">
            <div class="modal-dialog modal-sm">
              <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                  <h1 class="modal-title text-center" style="color:black; font-size: 30px;">Delete Event</h1>
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body"> 
                  <form method="POST">
                      {% csrf_token %}
                      <fieldset class="form-group">
                          <p>Are you sure you want to delete the event: <br> "{{ object.title }}?"</p>
                      </fieldset>
                      <div class="form-group">
                          <button class="btn btn-warning" type="submit">Yes, Delete</button>
                          <button class="btn btn-danger" data-dismiss="modal">Cancel</button>
                      </div>
                  </form>
                </div>

                <!-- Modal footer -->
                <div class="modal-footer"></div>

              </div>
            </div>
          </div>

        {% endif %}

  </article>
{% endblock content %}
